<?php	$file = getcwd() . "/" . APPPATH . "controllers/MY_controller.php";			include $file;	class fsadfzerrwez_menu extends fsadfzerrwez_home{		function fsadfzerrwez_menu(){					parent::__construct();				$this->load->model('menu');			$this->load->model("submenu");		}				/***********************************************************************/		/**************************** START menu *******************************/				/***********************************************************************/				function menu(){								$this->check_login();						$data = $this->get_menu();				$data['submenu-url'] = get_back_url(base_url("submenu"), MODULE_MENU);			$this->load_page('menu', $this->lang->line('menu'), $data);		}				function ajax_menu(){				$this->check_login();			$data = $this->get_menu();			$model['data'] = $data;			$model['controller_name'] = $this->controller_name;			$this->load->view($this->home_directory . "menu-table", $model);		}				private function get_menu(){						$data = $this->get_page_config();				$sort_by = $this->input->get('sort_by');			$ascending = $this->input->get('ascending');						$query = $this->menu->get_menu($data['keywords'], $data['page'], $data['page_size'], $sort_by, $ascending, $num_rows, $this->language);			$this->set_paging_data($data, $query, $num_rows);									return $data;		}				function add_menu($id = null){										$this->check_login();			$this->load->model("menu");			$result = null;			$menu = null;				$err_msg = '';			$data = array();
			$data['back-url'] = get_back_url(base_url("menu"), MODULE_MENU);			if (is_post()){									$result = false;				$menu = $this->menu->get_post_data();								$this->form_validation->set_rules('title', 'title', 'trim|required');																//UPDATE CASE					if ($id){					$result = $this->menu->update($menu, $id);					if ($result){						$err_msg = get_saved_message('menu', $menu->title_en);						if ($this->input->post('save_and_continue') == false){															$this->set_flashdata($err_msg);							redirect($data['back-url']);						}					}						else{						$err_msg = get_saved_fail_message('menu', $menu->title_en);					}				}				else{											$result = $this->menu->insert($menu, get_user_id());											if ($result){													$err_msg = get_saved_message('menu', $menu->title_en);						if ($this->input->post('save_and_continue') == true){							//clear old data							$menu->clear_data();						}						else{							$this->set_flashdata($err_msg);							redirect($data['back-url']);						}					}					else{						$err_msg = get_saved_fail_message('menu', $menu->title_en);					}				}							}			else{								if ($id){										$menu = $this->menu->get_id($id);									}				else{										$menu = new menu();				}			}			$this->load->model('module');			$data['modules'] = $this->module->get_all_modules();						$data['id'] = $id;			$data['err_msg'] = $err_msg;			$data['result'] = $result;									$data['data'] = $menu;			$data['page'] = $this->input->get('page');			$data['page_size'] = $this->input->get('page_size');			$data['keywords'] = $this->input->get('keywords');						$title_page = $this->lang->line('menu');			if (!$menu){				$title_page = get_not_found_short();			}			$this->load_page('add-menu', $title_page, $data);		}				function active_menu(){						$this->check_login_ajax();						$active = $this->input->post('active');						$ids = $this->get_array_ids();									$this->menu->active_in($active, $ids);		}				function delete_menu(){			$this->check_login_ajax();									$ids = $this->get_array_ids();			$this->menu->delete_in($ids);		}				function update_menu_position(){						$this->check_login_ajax();						$id = $this->input->post('id');			$position = $this->input->post('position');			$is_up = $this->input->post('is_up');						$this->menu->update_position($id, $is_up, $position);		}				/***********************************************************************/		/**************************** END OF MENU *******************************/				/***********************************************************************/				/***********************************************************************/		/**************************** START SUBMENU *******************************/				/***********************************************************************/				function submenu($menu_id = null){			$this->check_login();			$data = $this->get_submenu($menu_id);			$this->load->model('menu');						$data['menu'] = $this->menu->get_all_menu_in_admin($this->language);			$data['menu-url'] = get_back_url(base_url("menu"), MODULE_MENU);			$this->load_page('submenu', $this->lang->line('submenu'), $data);		}				function ajax_submenu(){			$this->check_login();			$menu_id = $this->input->get('menu_id');						$data = $this->get_submenu($menu_id);						$model['data'] = $data;			$model['controller_name'] = $this->controller_name;			$this->load->view($this->home_directory . "submenu-table", $model);		}				function get_submenu_by_menu(){			$this->check_login_ajax();						$data = array();			$menu_id = $this->input->post('menu_id');			$data = $this->submenu->get_all_submenu_by_menu_in_admin($menu_id);				$data = json_encode($data);			echo $data;		}				private function get_submenu($menu_id){						$this->check_login();						$data = $this->get_page_config();				$sort_by = $this->input->get('sort_by');			$ascending = $this->input->get('ascending');						$query = $this->submenu->get_submenu($menu_id, $data['keywords'], $data['page'], $data['page_size'], $sort_by, $ascending, $num_rows, $this->language);			$this->set_paging_data($data, $query, $num_rows);			$data['menu_id'] = $menu_id;			return $data;		}				function add_submenu($id = null){							$this->check_login();									$result = null;			$submenu = null;				$err_msg = "";			$data = array();
			$data['back-url'] = get_back_url(base_url("menu"), MODULE_MENU);			if (is_post()){									$result = false;				$submenu = $this->submenu->get_post_data();												//UPDATE CASE					if ($id){					$result = $this->submenu->update($submenu, $id);					if ($result){						$err_msg = get_saved_message('submenu', $submenu->title_en);						if ($this->input->post('save_and_continue') == false){															$this->set_flashdata($err_msg);							redirect($data['back-url']);						}												}					else{						$err_msg = get_saved_fail_message('submenu', $submenu->title_en);					}				}				else{											$result = $this->submenu->insert($submenu, get_user_id());											if ($result){							$err_msg = get_saved_message('submenu', $submenu->title_en);						if ($this->input->post('save_and_continue') == true){							//clear old data							$submenu->clear_data();						}						else{							$this->set_flashdata($err_msg);							redirect($data['back-url']);						}												}					else{						$err_msg = get_saved_fail_message('submenu', $submenu->title_en);					}										}							}			else{								if ($id){										$submenu = $this->submenu->get_id($id);									}				else{										$submenu = new submenu();				}				if ($this->input->get('menu_id')){										$submenu->menu_id = $this->input->get('menu_id');				}			}			$this->load->model('module');			$data['modules'] = $this->module->get_all_modules();			$data['id'] = $id;			$data['err_msg'] = $err_msg;			$data['result'] = $result;			$this->load->model('menu');						$data['menu'] = $this->menu->get_all_menu_in_admin($this->language);			$data['data'] = $submenu;			$data['page'] = $this->input->get('page');			$data['page_size'] = $this->input->get('page_size');			$data['keywords'] = $this->input->get('keywords');						$title_page = $this->lang->line('submenu');;			if (!$submenu){				$title_page = $this->lang->line('data_not_found');			}			$this->load_page('add-submenu', $title_page, $data);		}				function active_submenu(){						$this->check_login_ajax();						$active = $this->input->post('active');						$ids = $this->get_array_ids();									$this->submenu->active_in($active, $ids);		}				function delete_submenu(){						$this->check_login_ajax();									$ids = $this->get_array_ids();									$this->submenu->delete_in($ids);		}				/***********************************************************************/		/**************************** END OF submenu *******************************/				/***********************************************************************/				/***********************************************************************/		/**************************** TREE MENU TOP *******************************/				/***********************************************************************/				function tree_menu(){			$this->check_login();			$data = array();						$data['menu'] = $this->menu->get_all_menu_array_in_admin();			$data['submenu'] = $this->submenu->get_all_submenu_array_in_admin();			$this->load_page('tree-menu', $this->lang->line('menu_tree'), $data);		}				function submenu_in_menu_tree(){			$this->check_login();			$menu_id = $this->input->get('menu_id');						$data['data'] = $this->submenu->get_all_submenu_by_menu_in_tree_menu_in_admin($menu_id, $this->language);			$model['data'] = $data;			$this->load->view($this->home_directory . "submenu-table-in-tree-menu.php", $model);		}				function swap_menu_position(){			if($this->is_login()){				$ids = $this->get_array_ids();								$this->menu->update_positions($ids);			}			else{				echo $this->lang->line('required_login');			}		}				function swap_submenu_position(){			if($this->is_login()){				$ids = $this->get_array_ids();												$this->submenu->update_positions($ids);			}			else{				echo $this->lang->line('required_login');			}		}				function update_submenu_position(){						$this->check_login_ajax();						$id = $this->input->post('id');			$position = $this->input->post('position');			$is_up = $this->input->post('is_up');						$this->submenu->update_position($id, $is_up, $position);		}				/***********************************************************************/		/**************************** END OF TREE MENU TOP *******************************/				/***********************************************************************/	}?>